<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Property &mdash; Prime Cyprus</title>
  <meta name="description" content="Property details ‚Äî Prime Cyprus">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">

<style>
:root {
  --bg-primary: #0a0e17;
  --bg-secondary: #111827;
  --bg-card: #161e2e;
  --bg-card-hover: #1c2640;
  --text-primary: #f1f5f9;
  --text-secondary: #94a3b8;
  --text-muted: #64748b;
  --gold: #d4a853;
  --gold-light: #e8c97a;
  --gold-glow: rgba(212, 168, 83, 0.15);
  --border: rgba(255, 255, 255, 0.06);
  --border-gold: rgba(212, 168, 83, 0.25);
  --font-display: 'Playfair Display', Georgia, serif;
  --font-body: 'DM Sans', -apple-system, sans-serif;
  --max-width: 1200px;
  --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
body { font-family: var(--font-body); background: var(--bg-primary); color: var(--text-primary); line-height: 1.7; font-size: 16px; overflow-x: hidden; }
a { color: var(--gold); text-decoration: none; transition: var(--transition); }
a:hover { color: var(--gold-light); }
img { max-width: 100%; height: auto; display: block; }

.container { max-width: var(--max-width); margin: 0 auto; padding: 0 24px; }

h1, h2, h3, h4 { font-family: var(--font-display); font-weight: 600; line-height: 1.2; letter-spacing: -0.02em; }
h1 { font-size: clamp(2rem, 4vw, 3rem); }
p { margin-bottom: 16px; color: var(--text-secondary); }

.btn { display: inline-flex; align-items: center; gap: 8px; padding: 14px 32px; font-family: var(--font-body); font-size: 0.95rem; font-weight: 600; border: none; border-radius: 6px; cursor: pointer; transition: var(--transition); text-decoration: none; }
.btn--primary { background: var(--gold); color: var(--bg-primary); }
.btn--primary:hover { background: var(--gold-light); color: var(--bg-primary); transform: translateY(-2px); box-shadow: 0 8px 30px rgba(212, 168, 83, 0.25); }
.btn--outline { background: transparent; color: var(--gold); border: 1.5px solid var(--border-gold); }
.btn--outline:hover { background: var(--gold-glow); color: var(--gold-light); border-color: var(--gold); }
.btn--sm { padding: 10px 24px; font-size: 0.85rem; }

/* Nav */
.nav { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; background: rgba(10, 14, 23, 0.85); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); transition: var(--transition); }
.nav__inner { display: flex; align-items: center; justify-content: space-between; height: 72px; max-width: var(--max-width); margin: 0 auto; padding: 0 24px; }
.nav__logo { font-family: var(--font-display); font-size: 1.4rem; font-weight: 700; color: var(--text-primary); display: flex; align-items: center; gap: 10px; }
.nav__logo .logo-accent { color: var(--gold); }
.nav__links { display: flex; align-items: center; gap: 36px; list-style: none; }
.nav__links a { font-size: 0.9rem; font-weight: 500; color: var(--text-secondary); transition: var(--transition); position: relative; }
.nav__links a:hover, .nav__links a.active { color: var(--text-primary); }
.nav__links a::after { content: ''; position: absolute; bottom: -4px; left: 0; width: 0; height: 1.5px; background: var(--gold); transition: var(--transition); }
.nav__links a:hover::after, .nav__links a.active::after { width: 100%; }
.nav__dropdown { position: relative; }
.nav__dropdown-trigger { font-size: 0.9rem; font-weight: 500; color: var(--text-secondary); cursor: pointer; display: inline-flex; align-items: center; gap: 4px; padding: 0; background: none; border: none; font-family: inherit; transition: var(--transition); }
.nav__dropdown:hover .nav__dropdown-trigger { color: var(--text-primary); }
.nav__dropdown-trigger::after { content: ''; display: inline-block; width: 0; height: 0; margin-left: 4px; border-left: 4px solid transparent; border-right: 4px solid transparent; border-top: 5px solid currentColor; vertical-align: middle; }
.nav__dropdown-menu { position: absolute; top: 100%; left: 50%; transform: translateX(-50%); margin-top: 8px; padding: 8px 0; background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px; min-width: 160px; box-shadow: 0 12px 40px rgba(0,0,0,0.4); list-style: none; opacity: 0; visibility: hidden; transition: opacity 0.2s ease, visibility 0.2s ease; z-index: 100; }
.nav__dropdown:hover .nav__dropdown-menu { opacity: 1; visibility: visible; }
.nav__dropdown-menu a { display: block; padding: 10px 20px; font-size: 0.9rem; color: var(--text-secondary); white-space: nowrap; transition: var(--transition); }
.nav__dropdown-menu a:hover { background: var(--gold-glow); color: var(--gold); }
.nav__cta { display: flex; align-items: center; gap: 16px; }
.nav__hamburger { display: none; flex-direction: column; gap: 5px; cursor: pointer; background: none; border: none; padding: 4px; }
.nav__hamburger span { display: block; width: 24px; height: 2px; background: var(--text-primary); transition: var(--transition); }

/* Loading state */
.loading { display: flex; align-items: center; justify-content: center; min-height: 60vh; padding-top: 72px; }
.loading__spinner { width: 40px; height: 40px; border: 2px solid var(--border); border-top-color: var(--gold); border-radius: 50%; animation: spin 0.8s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* Error state */
.error-state { text-align: center; padding: 120px 24px 80px; }
.error-state h2 { margin-bottom: 12px; }
.error-state p { color: var(--text-muted); margin-bottom: 32px; }

/* Page header */
.property-header { padding: 100px 0 48px; position: relative; overflow: hidden; }
.property-header::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse 60% 40% at 30% 30%, rgba(212, 168, 83, 0.04) 0%, transparent 60%); pointer-events: none; }

.breadcrumb { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 24px; }
.breadcrumb a { color: var(--text-muted); }
.breadcrumb a:hover { color: var(--gold); }
.breadcrumb .sep { opacity: 0.4; }

.property-header__meta { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; flex-wrap: wrap; }
.property-tag { padding: 4px 12px; border-radius: 100px; font-size: 0.75rem; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase; }
.property-tag--sale { background: var(--gold-glow); border: 1px solid var(--border-gold); color: var(--gold); }
.property-tag--rent { background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.2); color: #60a5fa; }
.property-tag--sold { background: rgba(100, 116, 139, 0.1); border: 1px solid var(--border); color: var(--text-muted); }
.property-tag--type { background: var(--bg-card); border: 1px solid var(--border); color: var(--text-secondary); }

.property-header h1 { margin-bottom: 8px; }
.property-location { font-size: 1rem; color: var(--text-muted); display: flex; align-items: center; gap: 6px; }
.property-location::before { content: 'üìç'; font-size: 0.9rem; }

/* Gallery */
.gallery { margin-bottom: 56px; }
.gallery__main { width: 100%; height: 520px; border-radius: 16px; overflow: hidden; background: var(--bg-card); margin-bottom: 12px; }
.gallery__main img { width: 100%; height: 100%; object-fit: cover; }
.gallery__main--placeholder { display: flex; align-items: center; justify-content: center; color: var(--text-muted); font-size: 3rem; }
.gallery__thumbs { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
.gallery__thumb { height: 120px; border-radius: 8px; overflow: hidden; cursor: pointer; opacity: 0.6; transition: var(--transition); background: var(--bg-card); }
.gallery__thumb:hover, .gallery__thumb.active { opacity: 1; }
.gallery__thumb img { width: 100%; height: 100%; object-fit: cover; }

/* Content layout */
.property-body { display: grid; grid-template-columns: 1fr 360px; gap: 48px; align-items: start; padding-bottom: 80px; }

/* Description */
.property-description h2 { font-size: 1.4rem; margin-bottom: 16px; color: var(--text-primary); }
.property-description p { color: var(--text-secondary); line-height: 1.9; }

/* Details list */
.details-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0; margin-top: 32px; border: 1px solid var(--border); border-radius: 12px; overflow: hidden; }
.detail-item { padding: 14px 20px; border-bottom: 1px solid var(--border); border-right: 1px solid var(--border); }
.detail-item:nth-child(even) { border-right: none; }
.detail-item:nth-last-child(-n+2) { border-bottom: none; }
.detail-item__label { font-size: 0.75rem; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px; }
.detail-item__value { font-size: 0.95rem; color: var(--text-primary); font-weight: 500; }

/* Sidebar */
.property-sidebar {}
.sidebar-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 32px; position: sticky; top: 96px; }
.sidebar-card::before { content: ''; display: block; height: 2px; background: linear-gradient(90deg, transparent, var(--gold), transparent); margin-bottom: 28px; border-radius: 2px; }
.sidebar-price { font-family: var(--font-display); font-size: 2.2rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px; }
.sidebar-price__label { font-size: 0.8rem; color: var(--text-muted); margin-bottom: 24px; display: block; }
.sidebar-card .btn { width: 100%; justify-content: center; margin-bottom: 12px; }
.sidebar-note { font-size: 0.8rem; color: var(--text-muted); text-align: center; margin-top: 16px; margin-bottom: 0; }

/* Share buttons */
.share-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 28px;
  padding-top: 24px;
  border-top: 1px solid var(--border);
}
.share-bar__label {
  font-size: 0.8rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-muted);
  margin-right: 4px;
}
.share-btn {
  display: inline-flex;
  align-items: center;
  gap: 7px;
  padding: 9px 16px;
  border-radius: 6px;
  font-family: var(--font-body);
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  border: 1.5px solid var(--border-gold);
  background: transparent;
  color: var(--gold);
  text-decoration: none;
}
.share-btn:hover {
  background: var(--gold-glow);
  color: var(--gold-light);
  border-color: var(--gold);
}
.share-btn--copied {
  border-color: rgba(74, 222, 128, 0.3);
  color: #4ade80;
  background: rgba(74, 222, 128, 0.08);
}
.share-btn svg { width: 15px; height: 15px; fill: currentColor; flex-shrink: 0; }

/* Footer */
.footer { background: var(--bg-secondary); border-top: 1px solid var(--border); padding: 64px 0 32px; }
.footer__grid { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 48px; margin-bottom: 48px; }
.footer__brand p { font-size: 0.9rem; color: var(--text-muted); max-width: 300px; margin-top: 16px; }
.footer h4 { font-family: var(--font-body); font-size: 0.8rem; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-muted); margin-bottom: 20px; }
.footer__links { list-style: none; }
.footer__links li { margin-bottom: 10px; }
.footer__links a { font-size: 0.9rem; color: var(--text-secondary); }
.footer__links a:hover { color: var(--gold); }
.footer__bottom { border-top: 1px solid var(--border); padding-top: 24px; display: flex; justify-content: space-between; align-items: center; font-size: 0.8rem; color: var(--text-muted); }

@media (max-width: 1024px) {
  .property-body { grid-template-columns: 1fr; }
  .sidebar-card { position: static; }
  .footer__grid { grid-template-columns: 1fr 1fr; }
}
@media (max-width: 768px) {
  .nav__links, .nav__cta .btn { display: none; }
  .nav__hamburger { display: flex; }
  .nav.mobile-open .nav__links { display: flex; flex-direction: column; position: absolute; top: 72px; left: 0; right: 0; background: var(--bg-primary); border-bottom: 1px solid var(--border); padding: 24px; gap: 20px; }
  .nav__dropdown-menu { position: static; transform: none; margin-top: 6px; margin-left: 0; opacity: 1; visibility: visible; box-shadow: none; border: none; padding-left: 12px; background: transparent; }
  .nav__dropdown-trigger::after { display: none; }
  .gallery__main { height: 280px; }
  .gallery__thumbs { grid-template-columns: repeat(3, 1fr); }
  .details-grid { grid-template-columns: 1fr; }
  .detail-item { border-right: none; }
  .detail-item:nth-last-child(-n+2) { border-bottom: 1px solid var(--border); }
  .detail-item:last-child { border-bottom: none; }
  .footer__grid { grid-template-columns: 1fr; gap: 32px; }
  .footer__bottom { flex-direction: column; gap: 16px; text-align: center; }
}
</style>
</head>
<body>

  <!-- Navigation -->
  <nav class="nav" role="navigation" aria-label="Main navigation">
    <div class="nav__inner">
      <a href="index.html" class="nav__logo">
        <span class="logo-accent">&#9670;</span> Prime <span class="logo-accent">Cyprus</span>
      </a>
      <ul class="nav__links">
        <li><a href="digital-wealth.html">Digital Wealth</a></li>
        <li><a href="residency-tax.html">Residency &amp; Tax</a></li>
        <li class="nav__dropdown">
          <span class="nav__dropdown-trigger">Properties</span>
          <ul class="nav__dropdown-menu">
            <li><a href="properties.html" class="active">Properties for Sale</a></li>
            <li><a href="rentals.html">Rentals</a></li>
            <li><a href="property-management.html">Property Management</a></li>
          </ul>
        </li>
        <li><a href="about.html">About</a></li>
      </ul>
      </div>
      <button class="nav__hamburger" aria-label="Toggle menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </nav>

  <!-- Loading state -->
  <div class="loading" id="loadingState">
    <div class="loading__spinner"></div>
  </div>

  <!-- Error state -->
  <div class="error-state" id="errorState" style="display:none;">
    <h2>Property not found</h2>
    <p>This listing may have been removed or the link is incorrect.</p>
    <a href="properties.html" class="btn btn--outline">&larr; Back to Properties</a>
  </div>

  <!-- Property content (populated by JS) -->
  <div id="propertyContent" style="display:none;">

    <div class="property-header">
      <div class="container">
        <div class="breadcrumb">
          <a href="index.html">Home</a>
          <span class="sep">/</span>
          <a href="properties.html">Properties</a>
          <span class="sep">/</span>
          <span id="breadcrumbTitle">Property</span>
        </div>
        <div class="property-header__meta">
          <span class="property-tag property-tag--type" id="propType"></span>
          <span class="property-tag" id="propStatus"></span>
        </div>
        <h1 id="propTitle"></h1>
        <p class="property-location" id="propLocation"></p>
      </div>
    </div>

    <div class="container">

      <!-- Gallery -->
      <div class="gallery">
        <div class="gallery__main" id="galleryMain"></div>
        <div class="gallery__thumbs" id="galleryThumbs"></div>
      </div>

      <!-- Body -->
      <div class="property-body">

        <div class="property-main">
          <!-- Description -->
          <div class="property-description">
            <h2>About this property</h2>
            <div id="propDescription"></div>
          </div>

          <!-- Details -->
          <div class="details-grid" id="detailsGrid"></div>

          <!-- Share -->
          <div class="share-bar">
            <span class="share-bar__label">Share</span>
            <button class="share-btn" onclick="shareWhatsApp()">
              <svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
              WhatsApp
            </button>
            <button class="share-btn" id="copyLinkBtn" onclick="copyLink()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg>
              Copy link
            </button>
          </div>
        </div>

        <!-- Sidebar -->
        <div class="property-sidebar">
          <div class="sidebar-card">
            <div class="sidebar-price" id="sidebarPrice"></div>
            <span class="sidebar-price__label" id="sidebarPriceLabel"></span>
            <a href="contact.html" class="btn btn--primary">Enquire About This Property &rarr;</a>
            <a href="contact.html" class="btn btn--outline">Book a Viewing</a>
            <p class="sidebar-note">Free consultation &mdash; no obligation</p>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer__grid">
        <div class="footer__brand">
          <a href="index.html" class="nav__logo">
            <span class="logo-accent">&#9670;</span> Prime <span class="logo-accent">Cyprus</span>
          </a>
          <p>Tax optimization, residency planning, and property investment for digital wealth builders. Based in Cyprus, serving clients globally.</p>
        </div>
        <div>
          <h4>Services</h4>
          <ul class="footer__links">
            <li><a href="residency-tax.html">Residency &amp; Tax</a></li>
            <li><a href="properties.html">Property Investment</a></li>
            <li><a href="digital-wealth.html">Digital Wealth Planning</a></li>
            <li><a href="contact.html">Book a Consultation</a></li>
          </ul>
        </div>
        <div>
          <h4>Resources</h4>
          <ul class="footer__links">
            <li><a href="insights.html">Insights</a></li>
            <li><a href="residency-tax.html#non-dom">Non-Dom Guide</a></li>
            <li><a href="residency-tax.html#60day">60-Day Rule</a></li>
            <li><a href="index.html#faq">FAQ</a></li>
          </ul>
        </div>
        <div>
          <h4>Company</h4>
          <ul class="footer__links">
            <li><a href="about.html">About Us</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </div>
      </div>
      <div class="footer__bottom">
        <span>&copy; 2026 Prime Cyprus. All rights reserved.</span>
        <span>General information only &mdash; not legal, tax, or financial advice.</span>
      </div>
    </div>
  </footer>

<script>
const SANITY_PROJECT_ID = '7ic15vv6';
const SANITY_DATASET = 'production';
const SANITY_API_VERSION = '2024-01-01';

function getSlugFromURL() {
  const params = new URLSearchParams(window.location.search);
  return params.get('slug');
}

async function fetchProperty(slug) {
  const query = encodeURIComponent(`*[_type == "property" && slug.current == "${slug}"][0]{
    title,
    slug,
    price,
    status,
    propertyType,
    location,
    bedrooms,
    bathrooms,
    sqm,
    yearBuilt,
    description,
    "images": images[].asset->url
  }`);
  const url = `https://${SANITY_PROJECT_ID}.api.sanity.io/v${SANITY_API_VERSION}/data/query/${SANITY_DATASET}?query=${query}`;
  const res = await fetch(url);
  const data = await res.json();
  return data.result;
}

function formatPrice(price, status) {
  if (!price) return 'Price on request';
  const formatted = '‚Ç¨' + price.toLocaleString();
  return formatted;
}

function getPriceLabel(status) {
  if (!status) return '';
  if (status === 'rent') return 'per month';
  if (status === 'sold') return 'sold';
  return 'asking price';
}

function getStatusTag(status) {
  if (!status) return '';
  const map = { sale: ['For Sale', 'sale'], rent: ['For Rent', 'rent'], sold: ['Sold', 'sold'] };
  const [label, cls] = map[status] || [status, 'sale'];
  return `<span class="property-tag property-tag--${cls}">${label}</span>`;
}

let images = [];
let currentImage = 0;

function setMainImage(index) {
  currentImage = index;
  const main = document.getElementById('galleryMain');
  if (images[index]) {
    main.innerHTML = `<img src="${images[index]}" alt="Property image ${index + 1}">`;
  }
  document.querySelectorAll('.gallery__thumb').forEach((t, i) => {
    t.classList.toggle('active', i === index);
  });
}

function renderProperty(p) {
  // Update page title
  document.title = `${p.title} ‚Äî Prime Cyprus`;

  // Breadcrumb
  document.getElementById('breadcrumbTitle').textContent = p.title;

  // Header
  document.getElementById('propType').textContent = p.propertyType || 'Property';
  document.getElementById('propStatus').outerHTML = getStatusTag(p.status);
  document.getElementById('propTitle').textContent = p.title;
  document.getElementById('propLocation').textContent = p.location || '';

  // Gallery
  images = p.images || [];
  const main = document.getElementById('galleryMain');
  const thumbs = document.getElementById('galleryThumbs');

  if (images.length > 0) {
    main.innerHTML = `<img src="${images[0]}" alt="${p.title}">`;
    thumbs.innerHTML = images.slice(0, 4).map((img, i) =>
      `<div class="gallery__thumb ${i === 0 ? 'active' : ''}" onclick="setMainImage(${i})">
        <img src="${img}" alt="Property image ${i + 1}">
      </div>`
    ).join('');
  } else {
    main.innerHTML = `<div class="gallery__main--placeholder">üè†</div>`;
    thumbs.style.display = 'none';
  }

  // Description
  const desc = document.getElementById('propDescription');
  if (p.description) {
    desc.innerHTML = p.description.split('\n').filter(Boolean).map(line => `<p>${line}</p>`).join('');
  } else {
    desc.innerHTML = '<p>Contact us for more information about this property.</p>';
  }

  // Details grid
  const details = [];
  if (p.propertyType) details.push({ label: 'Type', value: p.propertyType });
  if (p.location) details.push({ label: 'Location', value: p.location });
  if (p.sqm) details.push({ label: 'Floor Area', value: p.sqm + ' m¬≤' });
  if (p.yearBuilt) details.push({ label: 'Year Built', value: p.yearBuilt });
  if (p.bedrooms) details.push({ label: 'Bedrooms', value: p.bedrooms });
  if (p.bathrooms) details.push({ label: 'Bathrooms', value: p.bathrooms });

  document.getElementById('detailsGrid').innerHTML = details.map(d =>
    `<div class="detail-item">
      <div class="detail-item__label">${d.label}</div>
      <div class="detail-item__value">${d.value}</div>
    </div>`
  ).join('');

  // Sidebar price
  document.getElementById('sidebarPrice').textContent = formatPrice(p.price, p.status);
  document.getElementById('sidebarPriceLabel').textContent = getPriceLabel(p.status);

  // Show content
  document.getElementById('loadingState').style.display = 'none';
  document.getElementById('propertyContent').style.display = 'block';
}

async function init() {
  const slug = getSlugFromURL();
  if (!slug) {
    document.getElementById('loadingState').style.display = 'none';
    document.getElementById('errorState').style.display = 'block';
    return;
  }

  try {
    const property = await fetchProperty(slug);
    if (!property) {
      document.getElementById('loadingState').style.display = 'none';
      document.getElementById('errorState').style.display = 'block';
      return;
    }
    renderProperty(property);
  } catch (err) {
    console.error(err);
    document.getElementById('loadingState').style.display = 'none';
    document.getElementById('errorState').style.display = 'block';
  }
}

// Share functions
function shareWhatsApp() {
  const url = encodeURIComponent(window.location.href);
  const title = encodeURIComponent(document.title);
  window.open(`https://wa.me/?text=${title}%0A${url}`, '_blank');
}

function copyLink() {
  navigator.clipboard.writeText(window.location.href).then(() => {
    const btn = document.getElementById('copyLinkBtn');
    btn.classList.add('share-btn--copied');
    btn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg> Copied!`;
    setTimeout(() => {
      btn.classList.remove('share-btn--copied');
      btn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg> Copy link`;
    }, 2000);
  });
}

// Nav
document.addEventListener('DOMContentLoaded', () => {
  const hamburger = document.querySelector('.nav__hamburger');
  const nav = document.querySelector('.nav');
  if (hamburger) hamburger.addEventListener('click', () => nav.classList.toggle('mobile-open'));
  window.addEventListener('scroll', () => {
    nav.style.borderBottomColor = window.scrollY > 50 ? 'rgba(255,255,255,0.08)' : 'rgba(255,255,255,0.06)';
  });
  init();
});
</script>
</body>
</html>
